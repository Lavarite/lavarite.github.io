<!DOCTYPE html>
<html lang="en" ng-app="binaryApp">
<head>
  <meta charset="UTF-8" />
  <title>Base Converter & Binary Adder</title>

  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>

  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
      background-color: #1e1e2e;
      color: #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    .container {
      background: #28293d;
      max-width: 480px;
      width: 100%;
      margin: 20px;
      padding: 24px;
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
    }
    h1 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-size: 1.8rem;
      color: #74c0fc;
      text-align: center;
    }
    label {
      display: block;
      font-weight: bold;
      margin: 1rem 0 0.5rem;
      color: #e0e0e0;
    }
    .instruction {
      margin-bottom: 0.5rem;
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #a0a0a0;
    }
    select,
    input {
      width: 100%;
      padding: 0.6rem;
      font-size: 1rem;
      border: 1px solid #3e3f58;
      border-radius: 4px;
      background-color: #1e1e2e;
      color: #e0e0e0;
      box-sizing: border-box;
    }
    button {
      margin-top: 1.5rem;
      padding: 0.8rem;
      width: 100%;
      font-size: 1rem;
      font-weight: bold;
      background-color: #74c0fc;
      color: #1e1e2e;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.1s ease;
    }
    button:disabled {
      background-color: #52547a;
      cursor: not-allowed;
    }
    button:hover:not(:disabled) {
      background-color: #4dabf7;
      transform: translateY(-2px);
    }

    .tab-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 1rem;
      justify-content: center;
    }
    .tab-buttons button {
      flex: 1;
      margin-top: 0;
    }

    .result {
      margin-top: 1.5rem;
      font-size: 1.2rem;
      color: #74c0fc;
      font-weight: bold;
      text-align: center;
    }
    .overflow {
      color: #ff0000;
      font-size: 1rem;
      margin-left: 8px;
      vertical-align: middle;
    }
  </style>
</head>
<body ng-controller="controller">
<div class="container">

  <!-- TAB BUTTONS -->
  <div class="tab-buttons">
    <button ng-click="setTab('converter')"
            ng-style="activeTab === 'converter' && {'background-color': '#4dabf7'}">
      Base Converter
    </button>
    <button ng-click="setTab('adder')"
            ng-style="activeTab === 'adder' && {'background-color': '#4dabf7'}">
      Binary Adder
    </button>
  </div>

  <!-- BASE CONVERTER TAB -->
  <div ng-show="activeTab === 'converter'">
    <h1>Base Converter</h1>
    <label for="baseFrom">Convert From</label>
    <select id="baseFrom" ng-model="baseFrom" ng-change="updateValidInput()">
      <option ng-repeat="(key, value) in bases" value="{{key}}">{{value}}</option>
    </select>

    <div class="instruction">Enter a valid number in the selected base.</div>
    <input
      type="text"
      id="input"
      ng-model="input"
      ng-change="validateInput()"
      placeholder="e.g., 1010 for Binary, FF for Hex, etc."
    />

    <label for="baseTo">Convert To</label>
    <select id="baseTo" ng-model="baseTo">
      <option ng-repeat="(key, value) in bases" value="{{key}}">{{value}}</option>
    </select>

    <button ng-click="convert()" ng-disabled="!input || input === ''">Convert</button>
    <div class="result">
      Result: {{result}}
    </div>
  </div>

  <!-- BINARY ADDER TAB -->
  <div ng-show="activeTab === 'adder'">
    <h1>Binary Adder</h1>
    <label for="binary1">First Binary (8 bits max)</label>
    <input
      type="text"
      id="binary1"
      ng-model="binary1"
      ng-change="validateBinary1()"
      placeholder="e.g., 10101010"
    />

    <label for="binary2">Second Binary (8 bits max)</label>
    <input
      type="text"
      id="binary2"
      ng-model="binary2"
      ng-change="validateBinary2()"
      placeholder="e.g., 1100"
    />

    <button ng-click="addBinaries()"
            ng-disabled="!binary1 || !binary2">Add</button>
    <div class="result">
      Sum: {{ adderResult }}
      <span class="overflow" ng-if="overflow">Overflow!</span>
    </div>
  </div>

</div>

<script>
  var app = angular.module("binaryApp", []);

  app.controller("controller", function ($scope) {
    // ----------------------
    //  Tab Management
    // ----------------------
    $scope.activeTab = "converter";
    $scope.setTab = function(tab) {
      $scope.activeTab = tab;
    };

    // ----------------------
    //  Base Converter Setup
    // ----------------------
    const baseTable = { bin: 2, oct: 8, dec: 10, hex: 16 };
    const reMap     = { bin: /[^01]/g, oct: /[^0-7]/g, dec: /[^0-9]/g, hex: /[^0-9a-fA-F]/g };
    const lenMap    = { bin: 8,      oct: 3,         dec: 3,          hex: 2 };

    $scope.bases    = { bin: "Binary", oct: "Octal", dec: "Decimal", hex: "Hexadecimal" };
    $scope.baseFrom = "bin";
    $scope.baseTo   = "bin";
    $scope.input    = "";
    $scope.result   = "";

    // Validate the base-specific input length & allowed chars
    $scope.validateInput = function () {
      const base = $scope.baseFrom;
      let validInput = $scope.input.replace(reMap[base], "").substring(0, lenMap[base]);

      // Clamp value to 255 (Decimal)
      if (base === "oct" && parseInt(validInput, 8) > 255) validInput = "377";
      if (base === "dec" && parseInt(validInput, 10) > 255) validInput = "255";

      // Update if changed
      if ($scope.input !== validInput) {
        $scope.input = validInput;
      }
    };

    // Reset the fields when changing "Convert From"
    $scope.updateValidInput = function () {
      $scope.input = "";
      $scope.result = "";
    };

    // Convert from one base to another
    $scope.convert = function () {
      if ($scope.input) {
        try {
          const number = parseInt($scope.input, baseTable[$scope.baseFrom]);
          $scope.result = number.toString(baseTable[$scope.baseTo]).toUpperCase();
        } catch (error) {
          $scope.result = "Invalid input";
        }
      } else {
        $scope.result = "Invalid input";
      }
    };

    // ----------------------
    //  Binary Adder Setup
    // ----------------------
    $scope.binary1     = "";
    $scope.binary2     = "";
    $scope.adderResult = "";
    $scope.overflow    = false;

    // Validate each binary input
    $scope.validateBinary1 = function() {
      const valid = $scope.binary1.replace(/[^01]/g, "").substring(0, 8);
      if ($scope.binary1 !== valid) {
        $scope.binary1 = valid;
      }
    };
    $scope.validateBinary2 = function() {
      const valid = $scope.binary2.replace(/[^01]/g, "").substring(0, 8);
      if ($scope.binary2 !== valid) {
        $scope.binary2 = valid;
      }
    };

    // Add two 8-bit binary numbers
    $scope.addBinaries = function() {
      const val1 = parseInt($scope.binary1 || "0", 2);
      const val2 = parseInt($scope.binary2 || "0", 2);
      const sum = val1 + val2;

      // Check for overflow beyond 8 bits
      $scope.overflow = (sum > 255);

      // Convert to an 8-bit binary string
      const maskedSum = sum & 0xFF;
      $scope.adderResult = maskedSum.toString(2).padStart(8, "0");
    };
  });
</script>
</body>
</html>
